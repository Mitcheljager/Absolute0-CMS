[
<% @menus.each_with_index do |menu, index| %>
  {
    "id": <%= menu.id %>,
    "name": "<%= menu.name %>",
    "pages": [
      <% @pages.where(:menu_id => menu.id).each_with_index do |page, index| %>
        {
          "id": <%= page.id %>,
          "title": "<%= page.title %>"
        }<% unless index == @pages.where(:menu_id => menu.id).size - 1 %>,<% end %>
      <% end %>
    ]
  },
<% end %>
  {
    "id": 0,
    "name": "Pages without menu",
    "pages": [
      <% @pages.where(menu_id: [0, '']).each_with_index do |page, index| %>
        {
          "id": <%= page.id %>,
          "title": "<%= page.title %>"
        }<% unless index == @pages.where(menu_id: [0, '']).size - 1 %>,<% end %>
      <% end %>
    ]
  }
]
